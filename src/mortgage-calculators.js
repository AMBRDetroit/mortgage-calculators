(function(){function t(a){for(var b in a)a[b]=isNaN(parseFloat(a[b]))?0:0>parseFloat(a[b])?0:parseFloat(a[b]);return a}function q(a){var b=0==a.interestRate?0:a.interestRate/100,b=0==b?0:b/12,c=12*a.termInYears;return b*a.loanAmount*Math.pow(1+b,c)/(Math.pow(1+b,c)-1)}function u(a){var b=0==a.interestRate?0:a.interestRate/100,b=0==b?0:b/12,c=12*a.termInYears;return a.monthlyPrincipalPayment*(Math.pow(1+b,c)-1)/(b*Math.pow(1+b,c))}function c(a){return isNaN(parseFloat(a.toFixed(2)))?0:parseFloat(a.toFixed(2))}
window.mortgageCalculators={};window.mortgageCalculators.monthlyMortgagePayments=function(a){a=t(a);return c(q(a))};window.mortgageCalculators.monthlyMortgagePaymentsWithExtraPayments=function(a){a=t(a);for(var b=a.interestRate/100/12,h=12*a.termInYears,e=a.extraPaymentAmount,f=q({loanAmount:a.loanAmount,interestRate:a.interestRate,termInYears:a.termInYears}),d=a.loanAmount,g=f+e,m=[],p=0;p<=h;p++){var n=b*d,l=f-n+e;0<=d-l?d>=g&&(d-=l):(g=d,d-=g);0<d&&m.push({monthlyPayment:c(f+e),principalPayment:c(l),
interestPayment:c(n),balance:c(d)})}b=[];for(d=0;d<=Math.ceil(m.length);d+=12)b.push(m.slice(d,d+12));d=[];g=a.loanAmount;for(p=0;p<b.length;p++){for(var k=l=n=0;k<b[p].length;k++)n+=b[p][k].interestPayment,l+=b[p][k].principalPayment;0<=g-l?g>=l&&(g-=l):(l=g,g-=l);d.push({annualInterestPayment:c(n),annualPrincipalPayment:c(l),balance:c(g),monthlyBreakdown:b[p]})}return{withExtraPayment:{totalMonthlyPayment:c(f+e),interestRate:a.interestRate,term:a.termInYears,totalCost:c(m.length*(f+e)),payments:d},
withoutExtraPayment:{totalMonthlyPayment:c(f),interestRate:a.interestRate,term:a.termInYears,totalCost:c(f*h)}}};window.mortgageCalculators.howMuchCanIBorrow=function(a){a=t(a);var b=a.interestRate,h=a.termInYears,e=a.monthlyDebtPayment,f=a.grossMonthlyIncome,d=a.downPayment/100;a=a.yearlyPropertyTax/12+a.yearlyPropertyInsurance/12;var g=u({termInYears:h,interestRate:b,monthlyPrincipalPayment:.36*f-e-a}),b=u({termInYears:h,interestRate:b,monthlyPrincipalPayment:.43*f-e-a});return{conservative:{priceOfHome:c(g+
g*d),downPayment:c(g*d),loanAmount:c(g)},aggressive:{priceOfHome:c(b+b*d),downPayment:c(b*d),loanAmount:c(b)},futureMonthlyPayment:{conservative:{principalAndInterest:c(.36*f-e),taxesAndInsurance:c(a),totalMonthlyPayment:c(.36*f-e-a)},aggressive:{principalAndInterest:c(.43*f-e),taxesAndInsurance:c(a),totalMonthlyPayment:c(.43*f-e-a)}}}};window.mortgageCalculators.compareFifteenVsThirtyYearMortgages=function(a){a=t(a);var b=a.loanAmount,h=a.interestRate2;a=q({loanAmount:b,interestRate:a.interestRate1,
termInYears:15});h=q({loanAmount:b,interestRate:h,termInYears:30});return{fifteenYearMortgage:{monthlyMortgagePayment:c(a),totalInterest:c(180*a-b),totalPayments:c(180*a)},thirtyYearMortgage:{monthlyMortgagePayment:c(h),totalInterest:c(360*h-b),totalPayments:c(360*h)}}};window.mortgageCalculators.refinanceMortgage=function(a){a=t(a);var b=a.loanAmount,h=a.interestRate,e=a.termInYears,f=a.newInterestRate,d=a.newTermInYears,g=a.paymentsMade;a=q({loanAmount:b,interestRate:h,termInYears:e});for(var m=
b,p=0,n=0;n<g;n++){var l=h/100/12*m,k=a-l;0<=m-k&&(m-=k);p+=l}b=a*e*12-b-p;h=m;f=q({loanAmount:h,interestRate:f,termInYears:d});d=f*d*12-m;return{interestSaved:c(b-d),oldMonthlyMortgage:{monthlyMortgagePayment:c(a),remainingInterest:c(b)},newMonthlyMortgage:{newMortgageTotal:c(h),monthlyMortgagePayment:c(f),remainingInterest:c(d)}}};window.mortgageCalculators.comparefixedRateVsARM=function(a){a=t(a);var b=a.interestRate,h=a.termInYears,e=a.loanAmount,f=a.initialInterestRate,d=a.expectedAdjustmentRate,
g=a.monthsBeforeFirstAdjustment,m=a.monthsBetweenAdjustments;a=a.maximumInterestRate;if(0<h&&0<m){for(var b=q({loanAmount:e,interestRate:b,termInYears:h}),p=q({loanAmount:e,interestRate:f,termInYears:h}),n=0;n<g;n++)e-=p-f/100/12*e;for(var f=f+d,n=q({loanAmount:e,interestRate:f,termInYears:h-g/12}),l=0;l<m;l++)var k=f/100/12*e,k=n-k,e=e-k;for(var h=12*h-g-m,r,g=0;g<h;g+=m){f=f<a?f+d:a;n=q({loanAmount:e,interestRate:f,termInYears:(h-g)/12});for(r=0;r<m;r++)k=f/100/12*e,k=n-k,e-=k;r=n}return response=
{fixedRate:{monthlyMortgagePayment:c(b)},ARM:{initialMonthlyMortgagePayment:c(p),maxMonthlyMortgagePayment:c(r)}}}};window.mortgageCalculators.compareBuyVsRent=function(a){a=t(a);var b=a.monthlyRent,h=a.expectedAnnualRentIncrease,e=a.purchasePrice,f=a.downPayment/100*e,d=e-f,g=a.interestRate,m=a.howLongBeforeSelling,p=a.incomeTaxRate,n=a.annualAppreciation,l=q({loanAmount:d,interestRate:g,termInYears:a.termInYears});a=e;for(var e=e-d,k=l,r=0;r<m;r++)for(var u=0;12>u;u++)e=g/100/12*d,k=l-e,0<=d-k?
d>=k&&(d-=k):(k=d,d-=k),b+=h/100/12*b,k=l-p/100*e,f+=k-b,a+=n/12/100*a,e=a-d;b=.06*a;h=e-b;g=h-f;return{currentValueOfHome:c(a),totalOwedToBank:c(d),equityOnHome:c(e),savingWhenRenting:c(f),transactionalCosts:c(b),netCostOfOwnership:c(h),moneySavedByBuying:c(g)}}})();